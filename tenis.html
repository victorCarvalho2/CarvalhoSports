<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/tenis.css">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon"> 
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <title>Carvalho Sport's</title>
</head>

<body>

    <header>
        Carvalho Sport's
        <nav>
            <a id="pagina_inicial" href="inicial.html" target="_self">Página Inicial</a>
            <a class="chuteiras" href="chuteiras.html" target="_self">Chuteiras</a>
            <a class="camisas" href="camisas.html" target="_self">Camisas de Time</a>
            <a class="material" href="material.html" target="_self">Material Esportivo</a>
            <a class="tenis" href="tenis.html" target="_self">Tênis Esportivos</a>
            <a class="sair" href="index.php">Sair</a>
        </nav>
    </header>

    <section>
        <h2>Na Carvalho Sport's, temos:</h2>
        <h3>Todos os tipos de Tênis que você precisar.</h3>
    </section>

    <!-- Tênis 1 -->
    <section>
        <div>
            <img id="tenis_um" src="img/tenis/corri.jpg" alt="Nike Revolution 7">
            <img class="tenis_um" src="img/tenis/corri.jpg" alt="Nike Revolution 7">
            <img class="tenis_um" src="img/tenis/corri.jpg" alt="Nike Revolution 7">
            <img class="tenis_um" src="img/tenis/corri.jpg" alt="Nike Revolution 7">
            <img class="tenis_um" src="img/tenis/corri.jpg" alt="Nike Revolution 7">
        </div>
        <h2>Tênis Nike Revolution 7</h2>
        <h3>Disponível por <br> R$ 499,99</h3>
        <button class="comprar"  id="comprarMobile" data-nome="Nike Revolution 7" data-preco="499.99">Adicionar ao Carrinho</button>
    </section>

    <!-- Tênis 2 -->
    <section>
        <div>
            <img id="tenis_dois" src="img/tenis/corrida.jpg" alt="Nike Downshifter 13">
            <img class="tenis_dois" src="img/tenis/corrida.jpg" alt="Nike Downshifter 13">
            <img class="tenis_dois" src="img/tenis/corrida.jpg" alt="Nike Downshifter 13">
            <img class="tenis_dois" src="img/tenis/corrida.jpg" alt="Nike Downshifter 13">
            <img class="tenis_dois" src="img/tenis/corrida.jpg" alt="Nike Downshifter 13">
        </div>
        <h2>Tênis Nike Downshifter 13</h2>
        <h3>Disponível por <br> R$ 329,99</h3>
        <button class="comprar"  id="comprarMobile" data-nome="Nike Downshifter 13" data-preco="489.99">Adicionar ao Carrinho</button>
    </section>

    <!-- Tênis 3 -->
    <section>
        <div>
            <img id="tenis_tres" src="img/tenis/nike.jpg" alt="Nike Air Max AP Masculino">
            <img class="tenis_tres" src="img/tenis/nike.jpg" alt="Nike Air Max AP Masculino">
            <img class="tenis_tres" src="img/tenis/nike.jpg" alt="Nike Air Max AP Masculino">
            <img class="tenis_tres" src="img/tenis/nike.jpg" alt="Nike Air Max AP Masculino">
            <img class="tenis_tres" src="img/tenis/nike.jpg" alt="Nike Air Max AP Masculino">
        </div>
        <h2>Tênis Nike Air Max AP Masculino</h2>
        <h3>Disponível por <br> R$ 474,90</h3>
        <button class="comprar"  id="comprarMobile" data-nome=" Nike Air Max AP Masculino" data-preco="474.90">Adicionar ao Carrinho</button>   
    </section>

    <!-- Tênis 4 -->
    <section>
        <div>
            <img id="tenis_quatro" src="img/tenis/tenis.jpg" alt="Nike Renew Ride 3">
            <img class="tenis_quatro" src="img/tenis/tenis.jpg" alt="Nike Renew Ride 3">
            <img class="tenis_quatro" src="img/tenis/tenis.jpg" alt="Nike Renew Ride 3">
            <img class="tenis_quatro" src="img/tenis/tenis.jpg" alt="Nike Renew Ride 3">
            <img class="tenis_quatro" src="img/tenis/tenis.jpg" alt="Nike Renew Ride 3">
        </div>
        <h2>Tênis Nike Renew Ride 3 Masculino</h2>
        <h3>Disponível por <br> R$ 427,40</h3>
        <button class="comprar"  id="comprarMobile" data-nome="Nike Renew Ride 3" data-preco="427.40">Adicionar ao Carrinho</button>
    </section>

    <!-- SSSSSSSSSSSCCCCCCCCCCCCCCCCCCRRRRRRRRRRRRRRRRIIIIIIIIIIIIIIIIIIIIIPPPPPPPPPPPPPPPTTTTTTTTTTTTTTTTTT'S -->

   <!-- Carrinho -->
   <div class="carrinho">
    <h3>Carrinho de Compras</h3>
    <ul id="itensCarrinho"></ul>
    <p class="total">Total: R$ 0,00</p>
    <button id="finalizarCompra" class="finalizarMobile">Finalizar Compra</button>
    <div id="qrcode" style="margin-top: 20px;"></div>
    </div>

<script>
    let carrinho = [];

    function atualizarCarrinho() {
        const carrinhoUl = document.getElementById("itensCarrinho");
        const total = document.querySelector(".total");
        carrinhoUl.innerHTML = '';
        let totalCarrinho = 0;

        carrinho.forEach((item, index) => {
            const li = document.createElement("li");
            li.innerHTML = `${item.nome} - R$ ${item.preco.toFixed(2)} <button onclick="removerItem(${index})">Remover</button>`;
            carrinhoUl.appendChild(li);
            totalCarrinho += item.preco;
        });

        total.innerHTML = `Total: R$ ${totalCarrinho.toFixed(2)}`;
    }

    function adicionarCarrinho(event) {
        const nome = event.target.getAttribute("data-nome");
        const preco = parseFloat(event.target.getAttribute("data-preco"));
        carrinho.push({ nome, preco });
        atualizarCarrinho();
        alert(`✅ "${nome}" foi adicionado ao carrinho!`);
    }

    function removerItem(index) {
        carrinho.splice(index, 1);
        atualizarCarrinho();
    }

    document.querySelectorAll(".comprar").forEach(button => {
        button.addEventListener("click", adicionarCarrinho);
    });

    document.getElementById("finalizarCompra").addEventListener("click", () => {
        if (carrinho.length === 0) {
            alert("Seu carrinho está vazio.");
            return;
        }

        const totalCompra = carrinho.reduce((acc, item) => acc + item.preco, 0);
        const chavePix = "victor@gmail.com"; // SUBSTITUA PELA SUA CHAVE PIX REAL
        const nomeLoja = "Carvalho Sports";
        const cidade = "Duque de Caxias";
        const valor = totalCompra.toFixed(2);

        const payload = `00020126580014BR.GOV.BCB.PIX0136${chavePix.length.toString().padStart(2, '0')}${chavePix}
52040000
5303986
540${valor.length}${valor}
5802BR
5913${nomeLoja.padEnd(13)}
6011${cidade}
62070503***6304`.replace(/\s/g, '');

        function crc16(payload) {
            let polinomio = 0x1021;
            let resultado = 0xFFFF;
            for (let i = 0; i < payload.length; i++) {
                resultado ^= payload.charCodeAt(i) << 8;
                for (let j = 0; j < 8; j++) {
                    if ((resultado <<= 1) & 0x10000) {
                        resultado ^= polinomio;
                    }
                    resultado &= 0xFFFF;
                }
            }
            return resultado.toString(16).toUpperCase().padStart(4, '0');
        }

        const payloadCompleto = payload + crc16(payload);

        const qrCodeDiv = document.getElementById("qrcode");
        qrCodeDiv.innerHTML = "";
        QRCode.toCanvas(payloadCompleto, { width: 256 }, function (err, canvas) {
            if (err) {
                alert("Erro ao gerar QR Code");
                return;
            }
            qrCodeDiv.appendChild(canvas);
        });

        alert("✅ Compra iniciada! Escaneie o QR Code para pagar via PIX.");
    });
</script>
</body>

</html>