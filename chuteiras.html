<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="css/chuteiras.css" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
  <title>Carvalho Sport's - Chuteiras</title>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
</head>

<body>
  <header>
    Carvalho Sport's
    <nav>
      <a id="pagina_inicial" href="inicial.html">Página Inicial</a>
      <a class="chuteiras" href="chuteiras.html">Chuteiras</a>
      <a class="camisas" href="camisas.html">Camisas de Time</a>
      <a class="material" href="material.html">Material Esportivo</a>
      <a class="tenis" href="tenis.html">Tênis Esportivos</a>
      <a class="sair" href="index.php">Sair</a>
    </nav>
  </header>

  <section class="texto">
    <h2>Na Carvalho Sport's, temos:</h2>
    <h3>Todos os tipos de chuteiras que você precisar.</h3>
  </section>

  <!-- Produto 1 -->
  <section>
    <div>
      <img id="nike_azul" src="img/newChuteiras/chuteira azul/naike.jpg" alt="" />
      <img class="nike_azul" src="img/newChuteiras/chuteira azul/naike.jpg" alt="" />
      <img class="nike_azul" src="img/newChuteiras/chuteira azul/naike.jpg" alt="" />
      <img class="nike_azul" src="img/newChuteiras/chuteira azul/naike.jpg" alt="" />
      <img class="nike_azul" src="img/newChuteiras/chuteira azul/naike.jpg" alt="" />
    </div>
    <h2>Chuteira Nike Phantom GT2 Elite</h2>
    <h3>Disponivel por: R$ 997,49</h3>
    <button class="comprar" id="comprarMobile" data-nome="Nike Phantom GT2 Elite" data-preco="997.49">Adicionar ao Carrinho</button>
  </section>

  <!-- Produto 2 -->
  <section>
    <div>
      <img id="nike_preta" src="img/newChuteiras/chuteira preta/brack.jpg" alt="">
      <img class="nike_preta" src="img/newChuteiras/chuteira preta/brack.jpg" alt="">
      <img class="nike_preta" src="img/newChuteiras/chuteira preta/brack.jpg" alt="">
      <img class="nike_preta" src="img/newChuteiras/chuteira preta/brack.jpg" alt="">
      <img class="nike_preta" src="img/newChuteiras/chuteira preta/brack.jpg" alt="">
    </div>
    <h2>Chuteira Nike Zoom Mercurial Superfly 9 Elite XXV</h2>
    <h3>Disponivel por apenas: <br> R$ 533,99</h3>
    <button class="comprar" id="comprarMobile" data-nome="Nike Zoom Mercurial Superfly 9 Elite XXV" data-preco="533.99">Adicionar ao Carrinho</button>
  </section>

  <!-- Produto 3 rosa-->
  <section>
    <div>
      <img id="nike_rosa" src="img/newChuteiras/chuteira rosa/pik.jpg" alt="Chuteira Nike Phantom GX Academy" />
      <img class="nike_rosa" src="img/newChuteiras/chuteira rosa/pik.jpg" alt="Chuteira Nike Phantom GX Academy" />
      <img class="nike_rosa" src="img/newChuteiras/chuteira rosa/pik.jpg" alt="Chuteira Nike Phantom GX Academy" />
      <img class="nike_rosa" src="img/newChuteiras/chuteira rosa/pik.jpg" alt="Chuteira Nike Phantom GX Academy" />
      <img class="nike_rosa" src="img/newChuteiras/chuteira rosa/pik.jpg" alt="Chuteira Nike Phantom GX Academy" />
    </div>
    <h2>Chuteira Nike Phantom GX Academy</h2>
    <h3>Disponivel por apenas: <br>R$ 631,99</h3>
    <button class="comprar" id="comprarMobile" data-nome="Nike Phantom GX Academy" data-preco="631.99">Adicionar ao Carrinho</button>
  </section>

  <!-- Produto 4 verde -->
  <section>
    <div class="galeria">
      <img id="nike_verde" src="img/newChuteiras/chuteira verde/green.jpg" alt="Chuteira Nike Tiempo Legend" />
      <img class="nike_verde" src="img/newChuteiras/chuteira verde/green.jpg" alt="Chuteira Nike Tiempo Legend" />
      <img class="nike_verde" src="img/newChuteiras/chuteira verde/green.jpg" alt="Chuteira Nike Tiempo Legend" />
      <img class="nike_verde" src="img/newChuteiras/chuteira verde/green.jpg" alt="Chuteira Nike Tiempo Legend" />
      <img class="nike_verde" src="img/newChuteiras/chuteira verde/green.jpg" alt="Chuteira Nike Tiempo Legend" />
    </div>
    <h2>Chuteira Nike Tiempo Legend 10 Elite</h2>
    <h3>Disponivel por apenas: <br>R$ 489,99</h3>
    <button class="comprar" id="comprarMobile" data-nome="Nike Tiempo Legend 10 Elite" data-preco="489.99">Adicionar ao Carrinho</button>
  </section>


  <!-- Carrinho -->
  <div class="carrinho">
    <h3>Carrinho de Compras</h3>
    <ul id="itensCarrinho"></ul>
    <p class="total">Total: R$ 0,00</p>
    <button id="finalizarCompra" class="finalizarMobile">Finalizar Compra</button>
    <div id="qrcode" style="margin-top: 20px;"></div>
  </div>

  <script>
    let carrinho = [];

    function atualizarCarrinho() {
      const carrinhoUl = document.getElementById("itensCarrinho");
      const total = document.querySelector(".total");
      carrinhoUl.innerHTML = '';
      let totalCarrinho = 0;

      carrinho.forEach((item, index) => {
        const li = document.createElement("li");
        li.innerHTML = `${item.nome} - R$ ${item.preco.toFixed(2)} <button onclick="removerItem(${index})">Remover</button>`;
        carrinhoUl.appendChild(li);
        totalCarrinho += item.preco;
      });

      total.innerHTML = `Total: R$ ${totalCarrinho.toFixed(2)}`;
    }

    function adicionarCarrinho(event) {
      const nome = event.target.getAttribute("data-nome");
      const preco = parseFloat(event.target.getAttribute("data-preco"));
      carrinho.push({ nome, preco });
      atualizarCarrinho();
      alert(`✅ "${nome}" foi adicionado ao carrinho!`);
    }

    function removerItem(index) {
      carrinho.splice(index, 1);
      atualizarCarrinho();
    }

    document.querySelectorAll(".comprar").forEach(button => {
      button.addEventListener("click", adicionarCarrinho);
    });

    document.getElementById("finalizarCompra").addEventListener("click", () => {
      if (carrinho.length === 0) {
        alert("Seu carrinho está vazio.");
        return;
      }

      const totalCompra = carrinho.reduce((acc, item) => acc + item.preco, 0);
      const chavePix = "victor@gmail.com"; // SUBSTITUA PELA SUA CHAVE PIX REAL
      const nomeLoja = "Carvalho Sports";
      const cidade = "Duque de Caxias";
      const valor = totalCompra.toFixed(2);

      const payload = `00020126580014BR.GOV.BCB.PIX0136${chavePix.length.toString().padStart(2, '0')}${chavePix}
52040000
5303986
540${valor.length}${valor}
5802BR
5913${nomeLoja.padEnd(13)}
6011${cidade}
62070503***6304`.replace(/\s/g, '');

      function crc16(payload) {
        let polinomio = 0x1021;
        let resultado = 0xFFFF;
        for (let i = 0; i < payload.length; i++) {
          resultado ^= payload.charCodeAt(i) << 8;
          for (let j = 0; j < 8; j++) {
            if ((resultado <<= 1) & 0x10000) {
              resultado ^= polinomio;
            }
            resultado &= 0xFFFF;
          }
        }
        return resultado.toString(16).toUpperCase().padStart(4, '0');
      }

      const payloadCompleto = payload + crc16(payload);

      const qrCodeDiv = document.getElementById("qrcode");
      qrCodeDiv.innerHTML = "";
      QRCode.toCanvas(payloadCompleto, { width: 256 }, function (err, canvas) {
        if (err) {
          alert("Erro ao gerar QR Code");
          return;
        }
        qrCodeDiv.appendChild(canvas);
      });

      alert("✅ Compra iniciada! Escaneie o QR Code para pagar via PIX.");
    });

    localStorage.setItem("carrinho", JSON.stringify(carrinho)); // Garantir persistência
  </script>

</body>
</html>